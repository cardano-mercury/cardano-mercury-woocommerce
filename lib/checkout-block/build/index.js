(()=>{"use strict";const e=window.React,t=window.wp.htmlEntities,n=window.wp.element,a=window.wc.wcSettings,c=window.wp.components,{registerPaymentMethod:o}=window.wc.wcBlocksRegistry,r=(0,a.getSetting)("cardano_mercury_data",{});wp.hooks.addAction("experimental__woocommerce_blocks-checkout-render-checkout-form","cardano-mercury",(e=>{const t=wp.data.select("wc/store/payment").getActivePaymentMethod();window.wc.blocksCheckout.extensionCartUpdate({namespace:"cardano-mercury",data:{payment_method:t}})})),wp.hooks.addAction("experimental__woocommerce_blocks-checkout-set-active-payment-method","cardano-mercury",(e=>{window.wc.blocksCheckout.extensionCartUpdate({namespace:"cardano-mercury",data:{payment_method:e?.value}})}));const s=(0,t.decodeEntities)(r.title||"Cardano ($ADA)"),i=t=>(0,e.createElement)("p",null,t.value),l=t=>{const[n,a]=(0,e.useState)(t.chosen);return(0,e.createElement)(c.RadioControl,{label:"Select Native Asset",selected:n,options:t.currencies,onChange:e=>{a(e),t.updateCurrency(e)}})},d=a=>{const{eventRegistration:c,emitResponse:o}=a,{onPaymentSetup:s,onCheckoutBeforeProcessing:d}=c,m=a.billing.cartTotal.value*Math.pow(10,-1*a.billing.currency.minorUnit)*r.exchange_rate,u=m/r.ada_price,p=[];r.currencies.forEach((e=>{let t,n,a;if("ada"===e.unit)t=m/e.price,a=`${t.toFixed(e.decimals)} ₳`;else{if(n=Math.max(0,u-e.minUTxO),n<=0)return;if(t=n/e.perAdaPrice,t<=0)return;a=`${t.toFixed(e.decimals)} ${e.name} + ${e.minUTxO} ₳`}p.push({label:a,value:e.unit})}));const[w,y]=(0,e.useState)(null);return(0,n.useEffect)((()=>{const e=s((async()=>w?{type:o.responseTypes.SUCCESS,meta:{paymentMethodData:{cardano_currency:w}}}:{type:o.responseTypes.ERROR,message:"You must select the Cardano Native Asset you wish to pay with!"}));return()=>{e()}}),[w,o.responseTypes.ERROR,o.responseTypes.SUCCESS,s,d]),(0,e.createElement)("div",null,(0,e.createElement)(i,{value:(0,t.decodeEntities)(r.description||"")}),(0,e.createElement)(l,{currencies:p,chosen:w,updateCurrency:y}))};o({name:"cardano_mercury",label:(0,e.createElement)((t=>{const{PaymentMethodLabel:n}=t.components;return(0,e.createElement)(n,{text:s})}),null),content:(0,e.createElement)(d,null),edit:(0,e.createElement)(d,null),canMakePayment:()=>!0,ariaLabel:s,supports:{features:["products"]}})})();